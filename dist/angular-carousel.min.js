/**
 * Angular Carousel - Mobile friendly touch carousel for AngularJS
 * @version v0.2.5 - 2014-10-10
 * @link http://revolunet.github.com/angular-carousel
 * @author Julien Bouquillon <julien@revolunet.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
angular.module("angular-carousel",["ngTouch"]),angular.module("angular-carousel").directive("rnCarouselAutoSlide",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){var e=Math.round(1e3*parseFloat(d.rnCarouselAutoSlide)),f=increment=!1,g=c.children().length;b.carouselExposedIndex||(b.carouselExposedIndex=0),stopAutoplay=function(){angular.isDefined(f)&&a.cancel(f),f=void 0},increment=function(){b.carouselExposedIndex=b.carouselExposedIndex<g-1?b.carouselExposedIndex+1:0},restartTimer=function(){stopAutoplay(),f=a(increment,e)},b.$watch("carouselIndex",function(){restartTimer()}),restartTimer(),d.rnCarouselPauseOnHover&&"false"!=d.rnCarouselPauseOnHover&&(c.on("mouseenter",stopAutoplay),c.on("mouseleave",restartTimer)),b.$on("$destroy",function(){stopAutoplay(),c.off("mouseenter",stopAutoplay),c.off("mouseleave",restartTimer)})}}}]),angular.module("angular-carousel").directive("rnCarouselControls",[function(){return{restrict:"A",replace:!0,scope:{items:"=",index:"="},link:function(a){a.prev=function(){a.index>0&&a.index--},a.next=function(){a.index<a.items.length-1&&a.index++}},templateUrl:"carousel-controls.html"}}]),angular.module("angular-carousel").run(["$templateCache",function(a){a.put("carousel-controls.html",'<div class="rn-carousel-controls">\n  <span class="rn-carousel-control rn-carousel-control-prev" ng-click="prev()" ng-if="index > 0"></span>\n  <span class="rn-carousel-control rn-carousel-control-next" ng-click="next()" ng-if="index < items.length - 1"></span>\n</div>')}]),angular.module("angular-carousel").directive("rnCarouselIndicators",[function(){return{restrict:"A",replace:!0,scope:{items:"=",index:"="},templateUrl:"carousel-indicators.html"}}]),angular.module("angular-carousel").run(["$templateCache",function(a){a.put("carousel-indicators.html",'<div class="rn-carousel-indicator">\n <span ng-repeat="item in items" ng-click="$parent.index=$index" ng-class="{active: $index==$parent.index}"></span>\n</div>')}]),function(){"use strict";angular.module("angular-carousel").service("getCapabilities",function(){function a(){var a="transform";return["webkit","Moz","O","ms"].every(function(b){var c=b+"Transform";return"undefined"!=typeof document.body.style[c]?(a=c,!1):!0}),!1}function b(){var a,b=document.createElement("p"),c={webkitTransform:"-webkit-transform",msTransform:"-ms-transform",transform:"transform"};document.body.insertBefore(b,null);for(var d in c)void 0!==b.style[d]&&(b.style[d]="translate3d(1px,1px,1px)",a=window.getComputedStyle(b).getPropertyValue(c[d]));return document.body.removeChild(b),void 0!==a&&a.length>0&&"none"!==a}return{has3d:b(),transformProperty:a()}}).service("computeCarouselSlideStyle",function(){return function(a,b,c){var d=100*a+b,e=(100-Math.abs(d))/100;if("slide"==c)return{left:d+"%"};if("fadeAndSlide"==c){var f=0;return Math.abs(d)<100&&(f=e),{left:d+"%",opacity:f}}if("hexagon"==c){var g=100,h=0,i=70*(e-1);return g=-100*a>b?100:0,h=-100*a>b?i:-i,{transform:"rotateY("+h+"deg)",left:d+"%","-webkit-transform-origin":g+"% 50%"}}}}).service("getCarouselSlidesStyles",function(a){return function(b,c,d){var e=[];return angular.forEach(b,function(b,f){e.push(a(f,c,d))}),e}}).service("createStyleString",function(){return function(a){var b=[];return angular.forEach(a,function(a,c){b.push(c+":"+a)}),b.join(";")}}).directive("rnCarousel",["$swipe","$window","$document","$parse","$compile","$rootScope","getCapabilities","computeCarouselSlideStyle","createStyleString",function(a,b,c,d,e,f,g,h,i){{var j=0,k=.05;b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame}return{restrict:"A",scope:!0,compile:function(b,d){var e,f,g=b.children()[0].attributes,l=!1,m=!1;return b.addClass("rn-carousel-slides"),b.children().addClass("rn-carousel-slide"),["ng-repeat","data-ng-repeat","ng:repeat","x-ng-repeat"].every(function(a){var b=g[a];if(angular.isDefined(b)){var c=b.value.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),h=c[3];if(e=c[1],f=c[2],e)return angular.isDefined(d.rnCarouselBuffered)&&(m=!0,b.value=e+" in "+f+"|carouselSlice:carouselBufferIndex:carouselBufferSize",h&&(b.value+=" track by "+h)),l=!0,!1}return!0}),function(b,d){function e(a){v=!0,p({x:a.clientX,y:a.clientY},a)}function g(a){var b;angular.forEach(d.children(),function(c,d){b=i(h(d,a,"slide")),c.setAttribute("style",b)})}function l(a){var c=new Tweenable;c.tween({from:{x:u},to:{x:-100*a},duration:300,easing:"easeTo",step:function(a){b.$apply(function(){g(a.x)})},finish:function(){b.$apply(function(){b.carouselIndex=a,u=-100*a})}})}function m(){return d[0].getBoundingClientRect().width}function n(a){return c.bind("mouseup",e),w=m(),x=d.children()[0].getBoundingClientRect().left,q=!0,r=a.x,!1}function o(a){var b;if(q&&(b=a.x,y=r-b,y>2||-2>y)){v=!0;var c=u+100*-y/w;g(c)}return!1}function p(a,d){if(console.log("swipeEnd","scope.carouselIndex",b.carouselIndex),!d||v){c.unbind("mouseup",e),q=!1,v=!1,s=r-a.x,u+=100*-s/w;var f=k*w,g=-s,h=-Math[g>=0?"ceil":"floor"](g/w),i=Math.abs(g)>f;h+b.carouselIndex>=t.length&&(h=t.length-1-b.carouselIndex),h+b.carouselIndex<0&&(h=-b.carouselIndex);var j=i?h:0;s=b.carouselIndex+j,l(s)}}j++;var q,r,s,t,u=0,v=!1,w=null,x=null;d.addClass("rn-carousel"),a.bind(d,{start:n,move:o,end:p,cancel:function(a){p({},a)}});var y=0;b.$watchCollection(f,function(a){g(0),t=a}),b.carouselIndex=0}}}}])}(),function(){"use strict";angular.module("angular-carousel").filter("carouselSlice",function(){return function(a,b,c){return angular.isArray(a)?a.slice(b,b+c):angular.isObject(a)?a:void 0}})}();